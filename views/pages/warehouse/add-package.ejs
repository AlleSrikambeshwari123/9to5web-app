<% layout('./shared/__template')%>
<div class='gutters'>
    <div class='col-xl-12 col-lg-6 col-md-12 col-sm-12'>
        <input type='hidden' id='mid' value="<%=mid%>" />
        <input type='hidden' id='mtype' value="<%= ColLabel.toLowerCase() %>" />

        <div class='card'>
            <div class="card-header col-md-12">
                <h3> Receive New Package </h3>
            </div>
            <div class="card-body">
                <ul class="nav nav-pills nav-primary" id="myTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab"
                            aria-controls="home" aria-selected="true" aria-expanded="true">Overview</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab"
                            aria-controls="profile" aria-selected="false" aria-expanded="false">Packages</a>
                    </li>


                </ul>

                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade active show" id="home" role="tabpanel" aria-labelledby="home-tab"
                        aria-expanded="true">
                        <div>
                            <div class="clearfix">
                                <div class="btn-group custom-btn-group float-right" role="group">
                                    <%if(Number(manifest.stageId) <= 1 ){%>
                                    <button type="button" class="btn btn-primary btn-sm close-manifest">Close
                                        <%=ColLabel%></button>
                                    <%}%>
                                    <%if(Number(manifest.stageId) <= 2 ){%>
                                    <button type="button" class="btn btn-success btn-sm ship-manifest-btn"
                                        data-toggle='modal' data-target='#shipManifest'>Ship <%=ColLabel%></button>
                                    <%}%>
                                        <button type="button" class="btn btn-dark btn-sm export-manifest">Export Excel</button>

                                </div>
                            </div>
                        </div>
                        <div class='row'>
                            <div class='col-md-3'>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <p class="text-uppercase small">
                                    <strong>Date:</strong> <br/><%=manifest.DateCreatedDisplay %>
                                    </p>
                                    <address class='small'>
                                        <strong>VALUE:</strong><span class='total-value'></span><br>
                                        <strong>WEIGHT:</strong> <span class='total-weight'></span> <br>
                                        <strong>STAGE:</strong> <%=manifest.StageName%><br>
                                        <strong>CREATED BY:</strong> <%=manifest.CreatedBy%><br>
                                    </address>
                                </div>
                            </div>
                            <div class='col-md-9'>
                                <div class='row gutters pt-2 mt-4'>
                                    <div class="card-stats card-round col-xl-4 col-lg-6 col-md-6 col-sm-6">
                                        <div class="card card-body info-state">
                                            <div class="icon-type">
                                                <i class="fas fa-archive"></i>
                                            </div>
                                            <div class="sale-num">
                                                <h2 id='packageCount'>0</h2>
                                                <p>Packages</p>
                                            </div>
                                        </div>

                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab"
                        aria-expanded="false">
                        <div class='row'>
                            <% var showForm ='' 
                                if (manifest.StageId > 1){ 
                                    showForm ='display:none'
                               }%>
                            <div class='col-md-3 pkg-form' style='<%=showForm%>'>

                                <form method='post' id='cargoPackageForm'>
                                    <div class='form-group'>
                                        <label>Skid </label>
                                        <input type='text' class='form-control skid' name='skid' id='skid' required />
                                    </div>
                                    <div class='form-group'>
                                        <label>SkyBox <span class='text-info title customerName '></span></label>
                                        <input type='text' class='form-control skybox' name='skybox' required />
                                    </div>
                                    <div class='form-group'>
                                        <label>Tracking #</label>
                                        <input type='hidden' class='mid' value='<%=mid %>' />
                                        <input type='hidden' class='mtype' value='<%= ColLabel.toLowerCase() %>' />
                                        <input type='text' class='form-control trackingNo' name='trackingNo' required />
                                    </div>
                                    <div class='form-group'>
                                        <label>Description</label>
                                        <input type='text' class='form-control description' name='description'
                                            required />
                                    </div>
                                    <div class='form-group'>
                                        <label>Shipper</label>
                                        <input type='text' class='form-control shipper' name='shipper' />
                                    </div>
                                    <div class='form-group'>
                                        <label>Value</label>
                                        <input type='text' class='form-control package-value' name='value' required />
                                    </div>
                                    <div class='form-group'>
                                        <label>Pieces</label>
                                        <input type='text' class='form-control pieces' name='pieces' required />
                                    </div>

                                    <div class='form-group'>
                                        <label>Weight</label>
                                        <input type='text' class='form-control weight ' name='weight' />
                                    </div>
                                    <div class='form-group'>
                                        <button class='btn btn-primary savePackage' type='button'>
                                            Save</button>
                                    </div>
                                </form>

                            </div>
                            <div class='col-md-9'>
                                <table id='packageTable'
                                    class='display table table-bordered table-head-bg-info table-hover'
                                    style='width:100%;'>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="confirmPkgDel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2"
    aria-hidden="true" style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel2">Confirmation Required</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <input type='hidden' id='pkg-tracking' />
                Are you sure you want to delete this package?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary close-del" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-danger rm-package" id='rmPackage'>Delete</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="shipManifest" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2"
    aria-hidden="true" style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel2">Ship Manifest</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <label>Enter AWB #</label>
                <input type='text' class='form-control awb'>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary close-del" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-success ship-manifest" id='ship-manifest'>Ship Manifest</button>
            </div>
        </div>
    </div>
</div>

<% block('scripts').append('<script src="/vendor/datatables/dataTables.min.js"></script>')%>
<% block('scripts').append('<script src="/vendor/datatables/dataTables.bootstrap.min.js"></script>')%>
<% block('scripts').append('<script src="/vendor/datatables/custom/fixedHeader.js"></script>')%>
<% block('scripts').append('<script src="/js/packages/manifest-package.js"></script>')%>