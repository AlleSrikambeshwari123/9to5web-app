'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var currencyFormatter = require('currency-formatter');
var fonts = {
    Courier: {
        normal: 'Courier',
        bold: 'Courier-Bold',
        italics: 'Courier-Oblique',
        bolditalics: 'Courier-BoldOblique'
    },
    Helvetica: {
        normal: 'Helvetica',
        bold: 'Helvetica-Bold',
        italics: 'Helvetica-Oblique',
        bolditalics: 'Helvetica-BoldOblique'
    },
    Times: {
        normal: 'Times-Roman',
        bold: 'Times-Bold',
        italics: 'Times-Italic',
        bolditalics: 'Times-BoldItalic'
    },
    Symbol: {
        normal: 'Symbol'
    },
    ZapfDingbats: {
        normal: 'ZapfDingbats'
    }
};
var pdffonts = require('pdfmake/build/vfs_fonts');
var PdfPrinter = require('pdfmake');
var printer = new PdfPrinter(fonts);
var moment = require('moment');
var fs = require('fs');
var bwipjs = require('bwip-js');
Number.prototype.formatMoney = function (c, d, t) {
    var n = this,
        c = isNaN(c = Math.abs(c)) ? 2 : c,
        d = d == undefined ? "." : d,
        t = t == undefined ? "," : t,
        s = n < 0 ? "-" : "",
        i = String(parseInt(n = Math.abs(Number(n) || 0).toFixed(c))),
        j = (j = i.length) > 3 ? j % 3 : 0;
    return "" + s + (j ? i.substr(0, j) + t : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
};

var FlightManifest = exports.FlightManifest = function () {
    function FlightManifest() {
        _classCallCheck(this, FlightManifest);

        this.totalWeight = 0;
        this.packageCount = 0;
    }

    _createClass(FlightManifest, [{
        key: 'generateManifest',
        value: function generateManifest(manifest, packages) {
            var srv = this;
            srv.packageCount = packages.length;
            return new Promise(function (resolve, reject) {

                var docDefinition = {
                    footer: srv.generateFooter,
                    content: [{
                        stack: [{ text: "NINE TO FIVE IMPORT EXPORT", bold: true, fontSize: 11, alignment: "center" }, { margin: [0, 2], text: "1811 N.W. 51 Street Hanger 42 D", bold: true, fontSize: 9, alignment: "center" }, { margin: [0, 2], text: "Ft. Lauderale, Florida 33309", bold: true, fontSize: 9, alignment: "center" }, { margin: [0, 2], text: "FLIGHT MANIFEST", bold: true, fontSize: 11, alignment: "center" }]
                    }, {
                        margin: [0, 5, 0, 0],
                        table: {
                            headerRows: 0,
                            alignment: "center",
                            width: 400,
                            widths: ['*', '*'],
                            body: [[{ border: [false, false, false, false], text: "For Shipment:", fontSize: 8, alignment: 'right', margin: [0, 0, 2, 0], bold: true }, { border: [false, false, false, false], text: manifest.tailNum, fontSize: 8 }]]
                        }
                    }, {
                        table: {
                            headerRows: 0,
                            alignment: "center",

                            widths: [100, 100, 100, 100],
                            body: [[{ border: [false, false, false, false], text: 'Departure Date:', fontSize: 8, alignment: 'left', margin: [0, 0, 2, 0], bold: true }, { border: [false, false, false, false], text: moment.unix(manifest.shipDate).format("MM/DD/YYYY"), fontSize: 8 }, { border: [false, false, false, false], text: 'Departure Time:', fontSize: 8, alignment: 'left', margin: [0, 0, 2, 0], bold: true }, { border: [false, false, false, false], text: moment.unix(manifest.shipDate).format("hh:mm A"), fontSize: 8 }], [{ border: [false, false, false, false], text: 'Carrier:', fontSize: 8, alignment: 'left', margin: [0, 0, 2, 0], bold: true }, { border: [false, false, false, false], text: "", fontSize: 8 }, { border: [false, false, false, false], text: 'Airline Flight#:', fontSize: 8, alignment: 'left', margin: [0, 0, 2, 0], bold: true }, { border: [false, false, false, false], text: manifest.tailNum, fontSize: 8 }]]
                        }
                    }, {
                        margin: [0, 5],
                        table: {
                            headerRows: 1,
                            widths: ['*', '*', '*', '*', '*'],
                            body: srv.generatePackagesTable(packages)
                        }
                    }, {
                        margin: [5, 5],
                        table: {
                            headerRows: 0,
                            widths: ['*', '*'],
                            body: [[{ text: "Total Peice Count:      " + srv.packageCount, border: [false, false, false, false], bold: true }, { text: "Total Shipment Weight:   " + srv.totalWeight + " lbs", bold: true, border: [false, false, false, false] }]]

                        }

                    }],
                    defaultStyle: {
                        font: 'Helvetica',
                        fontSize: 8
                    }
                };

                var pdfDoc = printer.createPdfKitDocument(docDefinition);
                pdfDoc.pipe(fs.createWriteStream(manifest.mid + '-manifest.pdf'));
                pdfDoc.end();
                resolve({ completed: true });
            });
        }
    }, {
        key: 'generateFooter',
        value: function generateFooter(currentPage, pageCount) {
            return { text: "Page No: " + currentPage.toString() + '/' + pageCount, alignment: 'right', margin: [50, 10] };
        }
    }, {
        key: 'generatePackagesTable',
        value: function generatePackagesTable(packages) {
            var srv = this;
            var body = [[{ text: "AWB #", fillColor: "#cccccc" }, { text: "Shipper", fillColor: "#cccccc" }, { text: "Package No", fillColor: "#cccccc" }, { text: "Consignee", fillColor: "#cccccc" }, { text: "Weight lbs", fillColor: "#cccccc" }]];
            //add packages here 
            var totalWeight = 0;
            var totaldimWeight = 0;
            var displayweight = 0;
            packages.forEach(function (pkg) {
                displayweight = currencyFormatter.format(pkg.weight, {
                    symbol: '',
                    decimal: '.',
                    thousand: ',',
                    precision: 2,
                    format: '%v %s' // %s is the symbol and %v is the value
                });
                totalWeight += Number(pkg.weight);
                body.push([{ text: "AWB" + pkg.awb }, { text: pkg.awbInfo.shipper }, { text: "PK00" + pkg.id }, { text: pkg.awbInfo.customer.name }, { text: displayweight + "lbs" }]);
            });
            srv.totalWeight = totalWeight;
            // var dimw = currencyFormatter.format(totaldimWeight, {
            //     symbol: '',
            //     decimal: '.',
            //     thousand: ',',
            //     precision: 2,
            //     format: '%v %s' // %s is the symbol and %v is the value
            //   })


            return body;
        }
    }, {
        key: 'generatePackages',
        value: function generatePackages(pakcages) {
            return Promise(function (resolve, reject) {});
        }
    }]);

    return FlightManifest;
}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWwvRmxpZ2h0TWFuaWZlc3QuZXM2Il0sIm5hbWVzIjpbImN1cnJlbmN5Rm9ybWF0dGVyIiwicmVxdWlyZSIsImZvbnRzIiwiQ291cmllciIsIm5vcm1hbCIsImJvbGQiLCJpdGFsaWNzIiwiYm9sZGl0YWxpY3MiLCJIZWx2ZXRpY2EiLCJUaW1lcyIsIlN5bWJvbCIsIlphcGZEaW5nYmF0cyIsInBkZmZvbnRzIiwiUGRmUHJpbnRlciIsInByaW50ZXIiLCJtb21lbnQiLCJmcyIsImJ3aXBqcyIsIk51bWJlciIsInByb3RvdHlwZSIsImZvcm1hdE1vbmV5IiwiYyIsImQiLCJ0IiwibiIsImlzTmFOIiwiTWF0aCIsImFicyIsInVuZGVmaW5lZCIsInMiLCJpIiwiU3RyaW5nIiwicGFyc2VJbnQiLCJ0b0ZpeGVkIiwiaiIsImxlbmd0aCIsInN1YnN0ciIsInJlcGxhY2UiLCJzbGljZSIsIkZsaWdodE1hbmlmZXN0IiwidG90YWxXZWlnaHQiLCJwYWNrYWdlQ291bnQiLCJtYW5pZmVzdCIsInBhY2thZ2VzIiwic3J2IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJkb2NEZWZpbml0aW9uIiwiZm9vdGVyIiwiZ2VuZXJhdGVGb290ZXIiLCJjb250ZW50Iiwic3RhY2siLCJ0ZXh0IiwiZm9udFNpemUiLCJhbGlnbm1lbnQiLCJtYXJnaW4iLCJ0YWJsZSIsImhlYWRlclJvd3MiLCJ3aWR0aCIsIndpZHRocyIsImJvZHkiLCJib3JkZXIiLCJ0YWlsTnVtIiwidW5peCIsInNoaXBEYXRlIiwiZm9ybWF0IiwiZ2VuZXJhdGVQYWNrYWdlc1RhYmxlIiwiZGVmYXVsdFN0eWxlIiwiZm9udCIsInBkZkRvYyIsImNyZWF0ZVBkZktpdERvY3VtZW50IiwicGlwZSIsImNyZWF0ZVdyaXRlU3RyZWFtIiwibWlkIiwiZW5kIiwiY29tcGxldGVkIiwiY3VycmVudFBhZ2UiLCJwYWdlQ291bnQiLCJ0b1N0cmluZyIsImZpbGxDb2xvciIsInRvdGFsZGltV2VpZ2h0IiwiZGlzcGxheXdlaWdodCIsImZvckVhY2giLCJwa2ciLCJ3ZWlnaHQiLCJzeW1ib2wiLCJkZWNpbWFsIiwidGhvdXNhbmQiLCJwcmVjaXNpb24iLCJwdXNoIiwiYXdiIiwiYXdiSW5mbyIsInNoaXBwZXIiLCJpZCIsImN1c3RvbWVyIiwibmFtZSIsInBha2NhZ2VzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsSUFBSUEsb0JBQW9CQyxRQUFRLG9CQUFSLENBQXhCO0FBQ0MsSUFBSUMsUUFBUTtBQUNUQyxhQUFTO0FBQ1BDLGdCQUFRLFNBREQ7QUFFUEMsY0FBTSxjQUZDO0FBR1BDLGlCQUFTLGlCQUhGO0FBSVBDLHFCQUFhO0FBSk4sS0FEQTtBQU9UQyxlQUFXO0FBQ1RKLGdCQUFRLFdBREM7QUFFVEMsY0FBTSxnQkFGRztBQUdUQyxpQkFBUyxtQkFIQTtBQUlUQyxxQkFBYTtBQUpKLEtBUEY7QUFhVEUsV0FBTztBQUNMTCxnQkFBUSxhQURIO0FBRUxDLGNBQU0sWUFGRDtBQUdMQyxpQkFBUyxjQUhKO0FBSUxDLHFCQUFhO0FBSlIsS0FiRTtBQW1CVEcsWUFBUTtBQUNOTixnQkFBUTtBQURGLEtBbkJDO0FBc0JUTyxrQkFBYztBQUNaUCxnQkFBUTtBQURJO0FBdEJMLENBQVo7QUEwQkMsSUFBSVEsV0FBV1gsUUFBUSx5QkFBUixDQUFmO0FBQ0QsSUFBSVksYUFBYVosUUFBUSxTQUFSLENBQWpCO0FBQ0MsSUFBSWEsVUFBVSxJQUFJRCxVQUFKLENBQWVYLEtBQWYsQ0FBZDtBQUNBLElBQUlhLFNBQVVkLFFBQVEsUUFBUixDQUFkO0FBQ0EsSUFBSWUsS0FBS2YsUUFBUSxJQUFSLENBQVQ7QUFDQSxJQUFJZ0IsU0FBU2hCLFFBQVEsU0FBUixDQUFiO0FBQ0FpQixPQUFPQyxTQUFQLENBQWlCQyxXQUFqQixHQUErQixVQUFVQyxDQUFWLEVBQWFDLENBQWIsRUFBZ0JDLENBQWhCLEVBQW1CO0FBQ2hELFFBQUlDLElBQUksSUFBUjtBQUFBLFFBQ0lILElBQUlJLE1BQU1KLElBQUlLLEtBQUtDLEdBQUws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RUgsYUFYRDtBQVlBdEMsZ0JBQUlKLFdBQUosR0FBa0JBLFdBQWxCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBLG1CQUFPcUIsSUFBUDtBQUNIOzs7eUNBQ2dCb0MsUSxFQUFTO0FBQ3RCLG1CQUFPcEQsUUFBUSxVQUFDQyxPQUFELEVBQVNDLE1BQVQsRUFBa0IsQ0FFaEMsQ0FGTSxDQUFQO0FBR0giLCJmaWxlIjoiVXRpbC9GbGlnaHRNYW5pZmVzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBjdXJyZW5jeUZvcm1hdHRlciA9IHJlcXVpcmUoJ2N1cnJlbmN5LWZvcm1hdHRlcicpOyBcbiB2YXIgZm9udHMgPSB7XG4gICAgQ291cmllcjoge1xuICAgICAgbm9ybWFsOiAnQ291cmllcicsXG4gICAgICBib2xkOiAnQ291cmllci1Cb2xkJyxcbiAgICAgIGl0YWxpY3M6ICdDb3VyaWVyLU9ibGlxdWUnLFxuICAgICAgYm9sZGl0YWxpY3M6ICdDb3VyaWVyLUJvbGRPYmxpcXVlJ1xuICAgIH0sXG4gICAgSGVsdmV0aWNhOiB7XG4gICAgICBub3JtYWw6ICdIZWx2ZXRpY2EnLFxuICAgICAgYm9sZDogJ0hlbHZldGljYS1Cb2xkJyxcbiAgICAgIGl0YWxpY3M6ICdIZWx2ZXRpY2EtT2JsaXF1ZScsXG4gICAgICBib2xkaXRhbGljczogJ0hlbHZldGljYS1Cb2xkT2JsaXF1ZSdcbiAgICB9LFxuICAgIFRpbWVzOiB7XG4gICAgICBub3JtYWw6ICdUaW1lcy1Sb21hbicsXG4gICAgICBib2xkOiAnVGltZXMtQm9sZCcsXG4gICAgICBpdGFsaWNzOiAnVGltZXMtSXRhbGljJyxcbiAgICAgIGJvbGRpdGFsaWNzOiAnVGltZXMtQm9sZEl0YWxpYydcbiAgICB9LFxuICAgIFN5bWJvbDoge1xuICAgICAgbm9ybWFsOiAnU3ltYm9sJ1xuICAgIH0sXG4gICAgWmFwZkRpbmdiYXRzOiB7XG4gICAgICBub3JtYWw6ICdaYXBmRGluZ2JhdHMnXG4gICAgfVxuICB9O1xuICB2YXIgcGRmZm9udHMgPSByZXF1aXJlKCdwZGZtYWtlL2J1aWxkL3Zmc19mb250cycpXG4gdmFyIFBkZlByaW50ZXIgPSByZXF1aXJlKCdwZGZtYWtlJyk7XG4gIHZhciBwcmludGVyID0gbmV3IFBkZlByaW50ZXIoZm9udHMpO1xuICB2YXIgbW9tZW50ICA9IHJlcXVpcmUoJ21vbWVudCcpOyBcbiAgdmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgdmFyIGJ3aXBqcyA9IHJlcXVpcmUoJ2J3aXAtanMnKVxuICBOdW1iZXIucHJvdG90eXBlLmZvcm1hdE1vbmV5ID0gZnVuY3Rpb24gKGMsIGQsIHQpIHtcbiAgICB2YXIgbiA9IHRoaXMsXG4gICAgICAgIGMgPSBpc05hTihjID0gTWF0aC5hYnMoYykpID8gMiA6IGMsXG4gICAgICAgIGQgPSBkID09IHVuZGVmaW5lZCA/IFwiLlwiIDogZCxcbiAgICAgICAgdCA9IHQgPT0gdW5kZWZpbmVkID8gXCIsXCIgOiB0LFxuICAgICAgICBzID0gbiA8IDAgPyBcIi1cIiA6IFwiXCIsXG4gICAgICAgIGkgPSBTdHJpbmcocGFyc2VJbnQobiA9IE1hdGguYWJzKE51bWJlcihuKSB8fCAwKS50b0ZpeGVkKGMpKSksXG4gICAgICAgIGogPSAoaiA9IGkubGVuZ3RoKSA+IDMgPyBqICUgMyA6IDA7XG4gICAgcmV0dXJuIFwiXCIgKyBzICsgKGogPyBpLnN1YnN0cigwLCBqKSArIHQgOiBcIlwiKSArIGkuc3Vic3RyKGopLnJlcGxhY2UoLyhcXGR7M30pKD89XFxkKS9nLCBcIjFcIiArIHQpICsgKGMgPyBkICsgTWF0aC5hYnMobiAtIGkpLnRvRml4ZWQoYykuc2xpY2UoMikgOiBcIlwiKTtcbn07XG5cbmV4cG9ydCBjbGFzcyBGbGlnaHRNYW5pZmVzdCB7IFxuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHRoaXMudG90YWxXZWlnaHQgID0wIDsgXG4gICAgICAgIHRoaXMucGFja2FnZUNvdW50ID0gMCA7IFxuICAgIH1cbiAgICBnZW5lcmF0ZU1hbmlmZXN0KG1hbmlmZXN0LHBhY2thZ2VzKXtcbiAgICAgICAgdmFyIHNydiA9IHRoaXM7IFxuICAgICAgIHNydi5wYWNrYWdlQ291bnQgPSBwYWNrYWdlcy5sZW5ndGg7IFxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUscmVqZWN0KT0+e1xuXG5cbiAgICAgICAgICAgIHZhciBkb2NEZWZpbml0aW9uID0geyBcbiAgICAgICAgICAgICAgICBmb290ZXI6IHNydi5nZW5lcmF0ZUZvb3RlcixcbiAgICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrIDpbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3RleHQ6XCJOSU5FIFRPIEZJVkUgSU1QT1JUIEVYUE9SVFwiLGJvbGQ6dHJ1ZSxmb250U2l6ZToxMSxhbGlnbm1lbnQ6XCJjZW50ZXJcIn0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge21hcmdpbjpbMCwyXSx0ZXh0OlwiMTgxMSBOLlcuIDUxIFN0cmVldCBIYW5nZXIgNDIgRFwiLGJvbGQ6dHJ1ZSxmb250U2l6ZTo5LGFsaWdubWVudDpcImNlbnRlclwifSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bWFyZ2luOlswLDJdLHRleHQ6XCJGdC4gTGF1ZGVyYWxlLCBGbG9yaWRhIDMzMzA5XCIsYm9sZDp0cnVlLGZvbnRTaXplOjksYWxpZ25tZW50OlwiY2VudGVyXCJ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHttYXJnaW46WzAsMl0sdGV4dDpcIkZMSUdIVCBNQU5JRkVTVFwiLGJvbGQ6dHJ1ZSxmb250U2l6ZToxMSxhbGlnbm1lbnQ6XCJjZW50ZXJcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luOlswLDUsMCwwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJSb3dzOjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50OlwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6NDAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoczpbJyonLCcqJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTpbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt7Ym9yZGVyOltmYWxzZSxmYWxzZSxmYWxzZSxmYWxzZV0sdGV4dDpcIkZvciBTaGlwbWVudDpcIixmb250U2l6ZTo4LGFsaWdubWVudDoncmlnaHQnLG1hcmdpbjpbMCwwLDIsMF0sYm9sZDp0cnVlfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2JvcmRlcjpbZmFsc2UsZmFsc2UsZmFsc2UsZmFsc2VdLHRleHQ6bWFuaWZlc3QudGFpbE51bSxmb250U2l6ZTo4fV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJSb3dzOjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50OlwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGhzOlsxMDAsMTAwLDEwMCwxMDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Ym9yZGVyOltmYWxzZSxmYWxzZSxmYWxzZSxmYWxzZV0sdGV4dDonRGVwYXJ0dXJlIERhdGU6Jyxmb250U2l6ZTo4LGFsaWdubWVudDonbGVmdCcsbWFyZ2luOlswLDAsMiwwXSxib2xkOnRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2JvcmRlcjpbZmFsc2UsZmFsc2UsZmFsc2UsZmFsc2VdLHRleHQ6bW9tZW50LnVuaXgobWFuaWZlc3Quc2hpcERhdGUpLmZvcm1hdChcIk1NL0REL1lZWVlcIiksZm9udFNpemU6OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Ym9yZGVyOltmYWxzZSxmYWxzZSxmYWxzZSxmYWxzZV0sdGV4dDonRGVwYXJ0dXJlIFRpbWU6Jyxmb250U2l6ZTo4LGFsaWdubWVudDonbGVmdCcsbWFyZ2luOlswLDAsMiwwXSxib2xkOnRydWV9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2JvcmRlcjpbZmFsc2UsZmFsc2UsZmFsc2UsZmFsc2VdLHRleHQ6bW9tZW50LnVuaXgobWFuaWZlc3Quc2hpcERhdGUpLmZvcm1hdChcImhoOm1tIEFcIiksZm9udFNpemU6OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtib3JkZXI6W2ZhbHNlLGZhbHNlLGZhbHNlLGZhbHNlXSx0ZXh0OidDYXJyaWVyOicsZm9udFNpemU6OCxhbGlnbm1lbnQ6J2xlZnQnLG1hcmdpbjpbMCwwLDIsMF0sYm9sZDp0cnVlfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtib3JkZXI6W2ZhbHNlLGZhbHNlLGZhbHNlLGZhbHNlXSx0ZXh0OlwiXCIsZm9udFNpemU6OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Ym9yZGVyOltmYWxzZSxmYWxzZSxmYWxzZSxmYWxzZV0sdGV4dDonQWlybGluZSBGbGlnaHQjOicsZm9udFNpemU6OCxhbGlnbm1lbnQ6J2xlZnQnLG1hcmdpbjpbMCwwLDIsMF0sYm9sZDp0cnVlfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtib3JkZXI6W2ZhbHNlLGZhbHNlLGZhbHNlLGZhbHNlXSx0ZXh0Om1hbmlmZXN0LnRhaWxOdW0sZm9udFNpemU6OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjpbMCw1XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJSb3dzOjEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGhzOlsnKicsJyonLCcqJywnKicsJyonXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OnNydi5nZW5lcmF0ZVBhY2thZ2VzVGFibGUocGFja2FnZXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjpbNSw1XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJSb3dzOjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGhzOlsnKicsJyonXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OltcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3t0ZXh0OlwiVG90YWwgUGVpY2UgQ291bnQ6ICAgICAgXCIrc3J2LnBhY2thZ2VDb3VudCwgYm9yZGVyOltmYWxzZSxmYWxzZSxmYWxzZSxmYWxzZV0sYm9sZDp0cnVlfSx7dGV4dDpcIlRvdGFsIFNoaXBtZW50IFdlaWdodDogICBcIitzcnYudG90YWxXZWlnaHQrXCIgbGJzXCIsYm9sZDp0cnVlLGJvcmRlcjpbZmFsc2UsZmFsc2UsZmFsc2UsZmFsc2VdfV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIGRlZmF1bHRTdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmb250OiAnSGVsdmV0aWNhJyxcbiAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6OFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07IFxuXG4gICAgICAgICAgICB2YXIgcGRmRG9jID0gcHJpbnRlci5jcmVhdGVQZGZLaXREb2N1bWVudChkb2NEZWZpbml0aW9uKTtcbiAgICAgICAgICAgIHBkZkRvYy5waXBlKGZzLmNyZWF0ZVdyaXRlU3RyZWFtKG1hbmlmZXN0Lm1pZCsnLW1hbmlmZXN0LnBkZicpKTtcbiAgICAgICAgICAgIHBkZkRvYy5lbmQoKTtcbiAgICAgICAgICAgIHJlc29sdmUoe2NvbXBsZXRlZDp0cnVlfSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgZ2VuZXJhdGVGb290ZXIoY3VycmVudFBhZ2UsIHBhZ2VDb3VudCl7XG4gICAgICAgIHJldHVybiAgICAgICAgeyB0ZXh0OiBcIlBhZ2UgTm86IFwiICsgY3VycmVudFBhZ2UudG9TdHJpbmcoKSArICcvJyArIHBhZ2VDb3VudCwgYWxpZ25tZW50OiAncmlnaHQnLCBtYXJnaW46WzUwLDEwXSB9XG4gICAgICAgICAgICAgICAgICAgICBcbiAgICB9XG4gICAgZ2VuZXJhdGVQYWNrYWdlc1RhYmxlKHBhY2thZ2VzKXtcbiAgICAgICAgdmFyIHNydiA9IHRoaXM7IFxuICAgICAgICBsZXQgYm9keSA9IFtcbiAgICAgICAgICAgIFt7dGV4dDpcIkFXQiAjXCIsZmlsbENvbG9yOlwiI2NjY2NjY1wifSxcbiAgICAgICAgICAgIHt0ZXh0OlwiU2hpcHBlclwiLGZpbGxDb2xvcjpcIiNjY2NjY2NcIn0sXG4gICAgICAgICAgICB7dGV4dDpcIlBhY2thZ2UgTm9cIixmaWxsQ29sb3I6XCIjY2NjY2NjXCJ9LFxuICAgICAgICAgICAge3RleHQ6XCJDb25zaWduZWVcIixmaWxsQ29sb3I6XCIjY2NjY2NjXCJ9LFxuICAgICAgICAgICAge3RleHQ6XCJXZWlnaHQgbGJzXCIsZmlsbENvbG9yOlwiI2NjY2NjY1wifSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIF1cbiAgICAgICAgLy9hZGQgcGFja2FnZXMgaGVyZSBcbiAgICAgICAgdmFyIHRvdGFsV2VpZ2h0ID0gMCA7IFxuICAgICAgICB2YXIgdG90YWxkaW1XZWlnaHQgPSAwIDsgXG4gICAgICAgIHZhciBkaXNwbGF5d2VpZ2h0ID0gMCA7IFxuICAgICAgICBwYWNrYWdlcy5mb3JFYWNoKHBrZyA9PiB7XG4gICAgICAgICAgICBkaXNwbGF5d2VpZ2h0ID0gY3VycmVuY3lGb3JtYXR0ZXIuZm9ybWF0KHBrZy53ZWlnaHQsIHtcbiAgICAgICAgICAgICAgICAgICAgc3ltYm9sOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgZGVjaW1hbDogJy4nLFxuICAgICAgICAgICAgICAgICAgICB0aG91c2FuZDogJywnLFxuICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IDIsXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdDogJyV2ICVzJyAvLyAlcyBpcyB0aGUgc3ltYm9sIGFuZCAldiBpcyB0aGUgdmFsdWVcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICB0b3RhbFdlaWdodCArPSBOdW1iZXIocGtnLndlaWdodCk7IFxuICAgICAgICAgICAgYm9keS5wdXNoKFt7dGV4dDpcIkFXQlwiK3BrZy5hd2J9LFxuICAgICAgICAgICAge3RleHQ6cGtnLmF3YkluZm8uc2hpcHBlcn0se3RleHQ6XCJQSzAwXCIrcGtnLmlkfSx7dGV4dDpwa2cuYXdiSW5mby5jdXN0b21lci5uYW1lfSx7dGV4dDpkaXNwbGF5d2VpZ2h0K1wibGJzXCJ9LF0pIFxuICAgICAgICB9KTtcbiAgICAgICAgc3J2LnRvdGFsV2VpZ2h0ID0gdG90YWxXZWlnaHQ7IFxuICAgICAgICAvLyB2YXIgZGltdyA9IGN1cnJlbmN5Rm9ybWF0dGVyLmZvcm1hdCh0b3RhbGRpbVdlaWdodCwge1xuICAgICAgICAvLyAgICAgc3ltYm9sOiAnJyxcbiAgICAgICAgLy8gICAgIGRlY2ltYWw6ICcuJyxcbiAgICAgICAgLy8gICAgIHRob3VzYW5kOiAnLCcsXG4gICAgICAgIC8vICAgICBwcmVjaXNpb246IDIsXG4gICAgICAgIC8vICAgICBmb3JtYXQ6ICcldiAlcycgLy8gJXMgaXMgdGhlIHN5bWJvbCBhbmQgJXYgaXMgdGhlIHZhbHVlXG4gICAgICAgIC8vICAgfSlcbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYm9keTsgXG4gICAgfVxuICAgIGdlbmVyYXRlUGFja2FnZXMocGFrY2FnZXMpe1xuICAgICAgICByZXR1cm4gUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57XG5cbiAgICAgICAgfSlcbiAgICB9XG5cbn0iXX0=
